$(document).ready(function(){function e(e){var o=e.getBounds(),t=o.getNorthEast(),n=o.getSouthWest();return[n.lat(),n.lng(),t.lat(),t.lng()]}function o(e){for(a(),i=0;i<e.length;i++){markerCount=i,markerCount++;var o=new google.maps.LatLng(e[i].latitude,e[i].longitude),t=new google.maps.Marker({position:o,icon:"https://chart.googleapis.com/chart?chst=d_map_spin&chld=1|0|fed136|13|_|"+markerCount,map:r});t.setMap(r),u.push(t)}}function t(e,t){var a=e.markers,s=e.results;o(a),t&&n(s)}function n(e){$("#results-container").replaceWith(e)}function a(){for(var e=0;e<u.length;e++)u[e].setMap(null);u=[]}function s(e,o){$.ajax({type:"GET",url:"/search",data:{bounds:e},insertResult:o,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){t(e,this.insertResult)},failure:function(e){alert(e)}})}if(!($(window).width()<768)){var r,l,g=new google.maps.Geocoder,p={scrollwheel:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_BOTTOM,mapTypeIds:[google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.ROADMAP]}},u=[];r=new google.maps.Map(document.getElementById("map"),p),google.maps.event.addListenerOnce(r,"idle",function(){var o=decodeURIComponent($.urlParam("location"));g.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){window.results=o;var n=new google.maps.LatLngBounds(o[0].geometry.viewport.getSouthWest(),o[0].geometry.viewport.getNorthEast());r.fitBounds(n),r.setZoom(10),l=e(r),s(l,!1),$("#map-search-box").show("slow")}else console.log("Geocode was not successful for the following reason: "+t)})}),google.maps.event.addListener(r,"dragend",function(){l=e(r),s(l,!0)}),$.urlParam=function(e){var o=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==o?null:o[1]||0}}});