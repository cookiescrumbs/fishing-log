!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var a,n=e(document);e.rails=a={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not(form button), button[data-confirm]:not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",CSRFProtection:function(t){var a=e('meta[name="csrf-token"]').attr("content");a&&t.setRequestHeader("X-CSRF-Token",a)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),a=e("meta[name=csrf-param]").attr("content");e('form input[name="'+a+'"]').val(t)},fire:function(t,a,n){var o=e.Event(a);return t.trigger(o,n),o.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e[0].href},handleRemote:function(n){var o,i,r,l,s,u;if(a.fire(n,"ajax:before")){if(l=n.data("with-credentials")||null,s=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,n.is("form")){o=n.attr("method"),i=n.attr("action"),r=n.serializeArray();var d=n.data("ujs:submit-button");d&&(r.push(d),n.data("ujs:submit-button",null))}else n.is(a.inputChangeSelector)?(o=n.data("method"),i=n.data("url"),r=n.serialize(),n.data("params")&&(r=r+"&"+n.data("params"))):n.is(a.buttonClickSelector)?(o=n.data("method")||"get",i=n.data("url"),r=n.serialize(),n.data("params")&&(r=r+"&"+n.data("params"))):(o=n.data("method"),i=a.href(n),r=n.data("params")||null);return u={type:o||"GET",data:r,dataType:s,beforeSend:function(e,o){return o.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+o.accepts.script),a.fire(n,"ajax:beforeSend",[e,o])?void n.trigger("ajax:send",e):!1},success:function(e,t,a){n.trigger("ajax:success",[e,t,a])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,a){n.trigger("ajax:error",[e,t,a])},crossDomain:a.isCrossDomain(i)},l&&(u.xhrFields={withCredentials:l}),i&&(u.url=i),a.ajax(u)}return!1},isCrossDomain:function(e){var t=document.createElement("a");t.href=location.href;var a=document.createElement("a");try{return a.href=e,a.href=a.href,!((!a.protocol||":"===a.protocol)&&!a.host||t.protocol+"//"+t.host==a.protocol+"//"+a.host)}catch(n){return!0}},handleMethod:function(n){var o=a.href(n),i=n.data("method"),r=n.attr("target"),l=e("meta[name=csrf-token]").attr("content"),s=e("meta[name=csrf-param]").attr("content"),u=e('<form method="post" action="'+o+'"></form>'),d='<input name="_method" value="'+i+'" type="hidden" />';s===t||l===t||a.isCrossDomain(o)||(d+='<input name="'+s+'" value="'+l+'" type="hidden" />'),r&&u.attr("target",r),u.hide().append(d).appendTo("body"),u.submit()},formElements:function(t,a){return t.is("form")?e(t[0].elements).filter(a):t.find(a)},disableFormElements:function(t){a.formElements(t,a.disableSelector).each(function(){a.disableFormElement(e(this))})},disableFormElement:function(e){var a,n;a=e.is("button")?"html":"val",n=e.data("disable-with"),e.data("ujs:enable-with",e[a]()),n!==t&&e[a](n),e.prop("disabled",!0)},enableFormElements:function(t){a.formElements(t,a.enableSelector).each(function(){a.enableFormElement(e(this))})},enableFormElement:function(e){var t=e.is("button")?"html":"val";e.data("ujs:enable-with")&&e[t](e.data("ujs:enable-with")),e.prop("disabled",!1)},allowAction:function(e){var t,n=e.data("confirm"),o=!1;return n?(a.fire(e,"confirm")&&(o=a.confirm(n),t=a.fire(e,"confirm:complete",[o])),o&&t):!0},blankInputs:function(t,a,n){var o,i,r=e(),l=a||"input,textarea",s=t.find(l);return s.each(function(){if(o=e(this),i=o.is("input[type=checkbox],input[type=radio]")?o.is(":checked"):o.val(),!i==!n){if(o.is("input[type=radio]")&&s.filter('input[type=radio]:checked[name="'+o.attr("name")+'"]').length)return!0;r=r.add(o)}}),r.length?r:!1},nonBlankInputs:function(e,t){return a.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){var n=e.data("disable-with");e.data("ujs:enable-with",e.html()),n!==t&&e.html(n),e.bind("click.railsDisable",function(e){return a.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},a.fire(n,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||a.CSRFProtection(n)}),n.delegate(a.linkDisableSelector,"ajax:complete",function(){a.enableElement(e(this))}),n.delegate(a.buttonDisableSelector,"ajax:complete",function(){a.enableFormElement(e(this))}),n.delegate(a.linkClickSelector,"click.rails",function(n){var o=e(this),i=o.data("method"),r=o.data("params"),l=n.metaKey||n.ctrlKey;if(!a.allowAction(o))return a.stopEverything(n);if(!l&&o.is(a.linkDisableSelector)&&a.disableElement(o),o.data("remote")!==t){if(l&&(!i||"GET"===i)&&!r)return!0;var s=a.handleRemote(o);return s===!1?a.enableElement(o):s.error(function(){a.enableElement(o)}),!1}return o.data("method")?(a.handleMethod(o),!1):void 0}),n.delegate(a.buttonClickSelector,"click.rails",function(t){var n=e(this);if(!a.allowAction(n))return a.stopEverything(t);n.is(a.buttonDisableSelector)&&a.disableFormElement(n);var o=a.handleRemote(n);return o===!1?a.enableFormElement(n):o.error(function(){a.enableFormElement(n)}),!1}),n.delegate(a.inputChangeSelector,"change.rails",function(t){var n=e(this);return a.allowAction(n)?(a.handleRemote(n),!1):a.stopEverything(t)}),n.delegate(a.formSubmitSelector,"submit.rails",function(n){var o,i,r=e(this),l=r.data("remote")!==t;if(!a.allowAction(r))return a.stopEverything(n);if(r.attr("novalidate")==t&&(o=a.blankInputs(r,a.requiredInputSelector),o&&a.fire(r,"ajax:aborted:required",[o])))return a.stopEverything(n);if(l){if(i=a.nonBlankInputs(r,a.fileInputSelector)){setTimeout(function(){a.disableFormElements(r)},13);var s=a.fire(r,"ajax:aborted:file",[i]);return s||setTimeout(function(){a.enableFormElements(r)},13),s}return a.handleRemote(r),!1}setTimeout(function(){a.disableFormElements(r)},13)}),n.delegate(a.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!a.allowAction(n))return a.stopEverything(t);var o=n.attr("name"),i=o?{name:o,value:n.val()}:null;n.closest("form").data("ujs:submit-button",i)}),n.delegate(a.formSubmitSelector,"ajax:send.rails",function(t){this==t.target&&a.disableFormElements(e(this))}),n.delegate(a.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&a.enableFormElements(e(this))}),e(function(){a.refreshCSRFTokens()}))}(jQuery),$(document).ready(function(){function e(e){var t=e.lat(),a=e.lng();$("#latitude")[0].value=t,$("#longitude")[0].value=a,$("#display-latitude").text(t),$("#display-longitude").text(a)}function t(e){var t=a();return t?t:e.getCenter()}function a(){var e=$("input#latitude").attr("value"),t=$("input#longitude").attr("value");return e&&t?new google.maps.LatLng(e,t):!1}function n(){var e=$("input#latitude").attr("value"),t=$("input#longitude").attr("value");e&t&&($("#display-latitude").text(e),$("#display-longitude").text(t))}function o(){return a()?a():{lat:53.4807593,lng:-2.2426305000000184}}function r(e){var t=e.getBounds(),a=t.getNorthEast(),n=t.getSouthWest();return[n.lat(),n.lng(),a.lat(),a.lng()]}function l(e){$.ajax({type:"GET",url:"/search",data:{bounds:e},contentType:"application/json; charset=utf-8",dataType:"json",success:s,failure:function(e){alert(e)}})}function s(e){var t=e.markers;u(t)}function u(e){for(d(),i=0;i<e.length;i++){markerCount=i,markerCount++;var t=new google.maps.LatLng(e[i].latitude,e[i].longitude),a=new google.maps.Marker({position:t,label:markerCount.toString(),map:m});a.setMap(m),b.push(a)}}function d(){for(var e=0;e<b.length;e++)b[e].setMap(null);b=[]}var m,c,p,f,b=[],g={scrollwheel:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_BOTTOM,mapTypeIds:[google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.ROADMAP]}};m=new google.maps.Map(document.getElementById("map"),g),m.setCenter(o()),m.setZoom(10),p=document.getElementById("map-search-box"),m.controls[google.maps.ControlPosition.TOP_LEFT].push(p),c=new google.maps.places.SearchBox(p),n(),google.maps.event.addListenerOnce(m,"idle",function(){f=new google.maps.Marker({position:t(m),icon:"https://chart.googleapis.com/chart?chst=d_map_spin&chld=1|0|fed136|13|_|",map:m,draggable:!0}),boundingBox=r(m),l(boundingBox),e(f.getPosition()),google.maps.event.addListener(f,"drag",function(){e(f.getPosition())}),google.maps.event.addListener(m,"dragend",function(){var t=m.getCenter();f.setPosition(t),e(f.getPosition()),boundingBox=r(m),l(boundingBox)}),google.maps.event.addListener(m,"zoom_changed",function(){var e=m.getCenter();f.setPosition(e),boundingBox=r(m),l(boundingBox)}),google.maps.event.addListener(c,"places_changed",function(){var t=c.getPlaces();if(!(t.length<=0)){var a=t[0],n=new google.maps.LatLngBounds;n.extend(a.geometry.location),m.fitBounds(n),m.setZoom(10),boundingBox=r(m),l(boundingBox),e(f.getPosition())}})})});