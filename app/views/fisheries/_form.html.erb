<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
<script>
// The following example creates a marker in Stockholm, Sweden
// using a DROP animation. Clicking on the marker will toggle
// the animation between a BOUNCE animation and no animation.

var stockholm = new google.maps.LatLng(59.32522, 18.07002);
var parliament = new google.maps.LatLng(59.327383, 18.06747);
var marker;
var map;

function initialize() {
  var mapOptions = {
    zoom: 13,
    center: stockholm
  };

  map = new google.maps.Map(document.getElementById('map'),
          mapOptions);

  marker = new google.maps.Marker({
    map:map,
    draggable:true,
    animation: google.maps.Animation.DROP,
    position: parliament
  });
  google.maps.event.addListener(marker, 'click', toggleBounce);
}

function toggleBounce() {

  if (marker.getAnimation() != null) {
    marker.setAnimation(null);
  } else {
    marker.setAnimation(google.maps.Animation.BOUNCE);
  }
}

google.maps.event.addDomListener(window, 'load', initialize);

</script>
<%= form_for(@fishery, :html => {:role => "form"}) do |f| %>
  <% if @fishery.errors.any? %>
    <div class="alert alert-danger">
      <strong><%= pluralize(@fishery.errors.count, "error") %> prohibited this fishery from being saved:</strong>
      <ul>
      <% @fishery.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <div class="form-group">
    <label for="fishery_name">Fishery Name</label>
    <%= f.text_field :name, class: "form-control", placeholder: "Enter fishery name"%>
  </div>
  <div class="form-group">
    <label for="fishery_contact_name">Contact</label>
    <%= f.text_field :contact_name, class: "form-control", placeholder: "Enter contact name"%>
  </div>
  <div class="form-group">
    <label for="fishery_street">Street</label>
    <%= f.text_field :street, class: "form-control", id:"fishery_street", placeholder: "Street"%>
  </div>
  <div class="form-group">
    <label for="fishery_line2">Line Two</label>
    <%= f.text_field :line2, class: "form-control", id:"fishery_line2", placeholder: "Line two"%>
  </div>
  <div class="form-group">
    <label for="fishery_region">County</label>
    <%= f.text_field :region, class: "form-control", id:"fishery_region", placeholder: "County"%>
  </div>
  <div class="form-group">
    <label for="fishery_country">Country</label>
    <%= f.text_field :country, class: "form-control", id:"fishery_country", placeholder: "Country"%>
  </div>
  <div class="form-group">
    <label for="fishery_postcode">Postcode</label>
    <%= f.text_field :postcode, class: "form-control", id:"fishery_postcode", placeholder: "Postcode"%>
  </div>
  <div class="form-group">
    <label for="fishery_telephone">Telephone Number</label>
    <%= f.text_field :telephone, class: "form-control", id:"fishery_telephone", placeholder: "Telephone Number"%>
  </div>
  <div class="form-group">
    <label for="fishery_email">Email Address</label>
    <%= f.text_field :email, class: "form-control", id:"fishery_email", placeholder: "Email Address"%>
  </div>
  <div class="form-group"> 
    <label for="fishery_insects">Natural insect life</label>
    <%= collection_check_boxes(:fishery, :insect_ids, Insect.all, :id, :name) do |b|%>
    <div class="checkbox">
      <%= b.check_box %>
      <%= b.label %>
    </div>
    <% end %>
  </div>
  <div class="form-group"> 
    <label for="fishery_species">Fish Species</label>
    <%= collection_check_boxes(:fishery, :species_ids, Species.all, :id, :name) do |b|%>
    <div class="checkbox">
      <%= b.check_box %>
      <%= b.label %>
    </div>
    <% end %>
  </div>
  <div style='width: 800px;'>
    <div id="map" style='width: 800px; height: 400px;'></div>
  </div>
  <div class="form-group">
    <label for="fishery_longitude">Longitude</label>
    <%= f.text_field :lng, class: "form-control", placeholder: "Enter longitude"%>
  </div>
  <div class="form-group">
    <label for="fishery_latitude">Latitude</label>
    <%= f.text_field :lat, class: "form-control", placeholder: "Enter latitude"%>
  </div>
  <div class="form-group">
    <label for="fishery_description">Description</label>
    <%= f.text_area :description, class: "form-control", placeholder: "Enter descripiton", size: "24x6"%>
  </div>
  <div class="form-group">
    <label for="fishery_record">Record</label>
    <%= f.text_field :record, class: "form-control", placeholder: "Enter fishery record"%>
  </div>
  <div class="form-group">
    <label for="fishery_prices">Prices</label>
    <%= f.text_field :prices, class: "form-control", placeholder: "Enter prices"%>
  </div>
  <div class="form-group">
    <label for="fishery_season">Season</label>
    <%= f.text_field :season, class: "form-control", placeholder: "Enter season"%>
  </div>
  <div class="form-group">
    <label for="fishery_facilities">Facilities</label>
    <%= f.text_field :facilities, class: "form-control", placeholder: "Enter facilities"%>
  </div>

    <%= button_tag "Submit", class: "btn btn-default" %>
<% end %>
<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers(
      [
        {
          "lat": 59.32522,
          "lng": 18.07002,
          "infowindow": "hello!",
          "draggable": true
        }
      ]
    );
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
  });
</script>